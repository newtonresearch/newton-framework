/*------------------------------------------------------------------------------	Get required resources.------------------------------------------------------------------------------*///OpenResFile(home & "Resources1");//DefineGlobalConstant('kIcon_mail,     GetPictAsBits("email", nil));//DefineGlobalConstant('kSoundPackage,	 GetNamedResource("pkg ", "sound", 'package));//CloseResFile();DefineGlobalConstant('kYearDigit,{	_proto: protoDigit,	preallocatedContext: 'years,	viewBounds: SetBounds(-23, 0, 0, 28),	icon: ROM_digitFlapLowOrd,	nextDigit: 'decades,	debug: 1451});DefineGlobalConstant('kDecadeDigit,{	_proto: protoDigit,	preallocatedContext: 'decades,	viewBounds: SetBounds(-22, 0, 0, 28),	icon: ROM_digitFlap,	nextDigit: 'centuries,	increment: 10,	GetIndex: func(inYear)		inYear mod 100 div 10,	debug: 4529});DefineGlobalConstant('kCenturyDigit,{	_proto: protoDigit,	preallocatedContext: 'centuries,	viewBounds: SetBounds(-36, 0, 1, 28),	icon: ROM_digitWideFlap,	increment: 100,	GetIndex: func(inYear)		inYear mod 10000 div 100,	viewDrawScript: func()		begin		local wideFrame := Clone(digitFrame);		wideFrame := OffsetRect(wideFrame, 1 - wideFrame.left, 0);		DrawXBitmap(wideFrame, digits, currentIndex div 10, copyMode);		wideFrame := OffsetRect(wideFrame, wideFrame.right - 1, 0);		DrawXBitmap(wideFrame, digits, currentIndex mod 10, copyMode)		end,	debug: 16733});DefineGlobalConstant('kNextPageButton,{	_proto: protoTextButton,	preallocatedContext: '_defaultButton,	viewBounds: SetBounds(-39, -18, -8, -5 ),	viewJustify: vjCenterH + vjCenterV + vjParentBottomV + vjSiblingLeftH + vjOneLineOnly,	text: "Next",	buttonClickScript: func()		begin		local isDone := not printView:printNextPageScript();		if isDone then			base:Close()		else			base:Dirty()		end});DefineGlobalConstant('kDivider,{	_proto: protoBorder,	preallocatedContext: 'divider,	viewBounds: nil,	viewJustify: vjParentFullH + vjParentTopV});DefineGlobalConstant('kDividerText,{	viewClass: clTextView,	viewFlags: vVisible + vReadOnly,	viewFormat: vfFillWhite,	viewBounds: nil,	viewJustify: vjCenterH + vjTopV,	text: nil,	preallocatedContext: 'dividerText});DefineGlobalConstant('kAboutBasic,{	_proto: protoStaticText,	preallocatedContext: 'basic,	viewFlags: vVisible,	viewFormat: nil,	viewBounds: SetBounds(8, 24, -8, -20),	viewJustify: vjParentFullH + vjParentFullV,	viewFont: tsSimple + tsSize(12) + tsPlain,	viewLineSpacing: 12,	text: nil,	viewSetupFormScript: func()		begin		local info := theApp.aboutInfo;		local extraInfo := info:?extraInfo(theApp);		local soupSize := 0;		local numOfEntries := 0;		foreach soup in theSoups do			begin			local crsr := soup:Query(nil);			numOfEntries := numOfEntries + crsr:CountEntries();			soupSize := soupSize + soup:GetSize();			end;		text := ParamStr("^?0^0\n\n||^?1^1\n||^?2^2\n||^?3^3\n||^?4^4\n||^?5^5\n||", [info.tagline, info.version, info.date, info.copyright, info.trademarks, extraInfo]);		if soupSize > 0 then			begin			soupSize := max(soupSize div 1024, 1);			text := text & (if numOfEntries = 0 then									ParamStr("\n^0K storage used", [soupSize])								else if numOfEntries = 1 then									ParamStr("\n^0K storage used for 1 ^1", [soupSize, theApp.appObject[0]])								else									ParamStr("\n^0K storage used for ^1 ^2", [soupSize, numOfEntries, theApp.appObject[1]]))			end		end});DefineGlobalConstant('kAboutCredits,{	viewClass: clView,	preallocatedContext: 'credits,	viewFlags: vfNone,	viewFormat: nil,	viewBounds: SetBounds(8, 32, -8, -20 ),	viewJustify: vjParentFullH + vjParentFullV,	viewEffect: fxVenetianBlindsEffect,	viewFont: tsHWFont + tsSize(12) + tsPlain,	viewLineSpacing: 14,	viewOriginY: 0,	viewSetupDoneScript: func()	begin		if not creditPict then			begin			local shape;			local height := 0;			local margin := (:LocalBox()).right;			local pieces := foreach item in theApp.aboutInfo.credits collect				if item[0] = $% then					begin					shape := [{ font: tsHWFont + tsSize(12) + tsPlain }, MakeText(Substr(item, 1, nil), 0, height, margin, height + 24)];					height := height + 30;					shape					end				else					begin					shape := MakeText(item, 15, height, margin, height + 12);					height := height + 14;					shape					end;			creditPict := MakePict(pieces, { font: tsHWFont + tsSize(10) + tsPlain });			creditHeight := height;			end;		:SetupIdle(5000)		end,	viewIdleScript: func()		begin		local box := :LocalBox();		local height := box.bottom - box.top;		local bottom := viewOriginY + height;		if bottom > creditHeight then			bottom := 0;		viewOriginY := bottom;		:Effect(fxVenetianBlindsEffect, nil, ROM_flip, nil, []);		5000		end,	viewDrawScript: func()		begin		:CopyBits(creditPict, 0, -viewOriginY, 0)		end});DefineGlobalConstant('kPrintChoose,{	_proto: protoPrinterChooserButton,	preallocatedContext: 'printChoose,	viewBounds: SetBounds(40, 55, -10, 71),	viewJustify: 0x800030});DefineGlobalConstant('kPrintPreview,{	_proto: {		_proto: protoTextButton,		viewBounds: SetBounds(11, 0, 59, 13),		viewJustify: 0x800006,		text: "Preview",		viewSetupFormScript: func()			begin			viewBounds := DeepClone(viewBounds);			viewBounds.top := envelopeHeight + bottomIndent - 19 - 2;			viewBounds.bottom := viewBounds.top + 13			end,		Preview: func(item)			begin			if transport:SetupFormat(item) <> nil then				:Notify(kNotifyAlert, "Print", "The print format for this item is missing")			else				begin				GetCurrentFormat(item):LastChanceToSetup(item);				local previewer := BuildContext(@141);				previewer.fields := item;				previewer:Open()				end			end,		buttonClickScript: func()			begin			:Preview(fields)			end	},	preallocatedContext: '_previewButton});DefineGlobalConstant('kNotesArea,{	_proto: newtEditView,	preallocatedContext: 'notesArea,	viewFlags: 0x1FFFE21,	viewFormat: 0x2000,	viewBounds: SetBounds(4, 25, -4, -20),	viewJustify: vjParentFullH + vjParentFullV,	viewLineSpacing: 28,	target: nil,	optionFlags: 1,	path: 'data,	notesDirty: nil,	viewSetupFormScript: func()		begin		:SetUpForm();		inherited:?viewSetupFormScript();		notesDirty := nil;		:?SetUpOther()		end,	viewQuitScript: func()		begin		:TearDownForm()		end,	viewChangedScript: func(arg1, arg2)		begin		notesDirty := true		end,	viewAddChildScript: func(arg1)		begin		notesDirty := true;		nil		end,	viewDropChildScript: func(arg1)		begin		notesDirty := true;		nil		end,	debug: 19835});DefineGlobalConstant('kPhoneNum,{	_proto: protoLabelInputLine,	preallocatedContext: 'phoneNum,	viewBounds: SetBounds(5, 55, 180, 90),	viewLineSpacing: 24,	label: "Phone #",	indent: 55,	entryFlags: 264705,	viewSetupFormScript: func()		begin		indent := StrFontWidth(label, labelFont) + 16		end});DefineGlobalConstant('kBookFinder,{	_proto: ROM_compatibleFinder,	CheckState: func(arg1) 'NotCheckable,	SelectItem: nil,	MoveTo: nil});/*------------------------------------------------------------------------------	Magic pointers 102 - 199------------------------------------------------------------------------------*/mp1xx := [/*------------------------------------------------------------------------------	@102	ROM_funBeep*/	{	sndFrameType: 'codec,		codecName: "TDTMFCodec",		dataType: 16,		bufferSize: 6400,		bufferCount: 4,		compressionType: 6,		samplingRate: 21600,		samples: MakeBinaryFromHex("00010000000000000003052800002710000000000000005A01222710000006720000271000000000002D005A009127100000089800002EE000000000005A005A006427100000", 'samples),		userName: "Trill"	},/*------------------------------------------------------------------------------	@103			Union Soup Cursor?*/	{	curses: nil,		finalCurse: 0,		metaCursor: nil,		New: func(arg1, arg2)			begin			local cursor := {_proto: self, curses: []};			if arg2 then				cursor.comparator := arg2;			if arg1 then				foreach local2 in arg1 do					cursor:addCursor(local2, nil);			cursor:Reset();			cursor			end,		Clone: func()			begin			local myClone := Clone(self);			myClone.metaCursor := Clone(metaCursor);			myClone.curses := Clone(myClone.curses);			for i := 0 to finalCurse - 1 do				begin				myClone.curses[i] := Clone(curses[i]);				myClone.curses[i].cursor := myClone.curses[i].cursor:Clone();				end;			myClone			end,		Comparator: func(arg1, arg2, arg3)			begin			if arg3 = '|=| then				IsSameEntry(arg1, arg2)			else				begin				local local1 := StrCompare(arg1.sorton, arg2.sorton);				(local1 < 0 and arg3 = '|<|)				or (local1 > 0 and arg3 = '|>|)				end			end,		AddCursor: func(arg1, arg2)			begin			local local1 := {cursor: arg1, id: if arg2 then arg2 else finalCurse, state: 'passed};			ArrayInsert(curses, local1, finalCurse);			finalCurse := finalCurse + 1			end,		ReplaceCursor: func(arg1, arg2)			begin			local local1;			for local1 := 0 to finalCurse - 1 do				if curses[local1].id = arg1 then				begin				curses[local1].cursor := arg2;				return true;				end;			nil			end,		Mover: func(arg1)			begin			local theEntry;			for i := 0 to Length(curses) - 1 do				begin				local curs := curses[i];				local fn := {					passed:  { prev: 'Prev, next: 'Entry },					resident:{ prev: 'Prev, Next: 'Next },					prior:	{ prev: 'Entry, Next: 'Next } }.(curs.state).(arg1);				local currEntry := Perform(curs.cursor, fn, []);				while currEntry = 'deleted do					currEntry := Perform(curs.cursor, fn, []);				if fn = arg1 then					(curs.state := { next: 'passed, prev: 'prior }.(arg1));				if currEntry				and (theEntry = nil or call comparator with (theEntry, currEntry, {next: '|>|, prev: '|<| }.(arg1))) then					begin					metaCursor := curs;					theEntry := currEntry					end				end;			if metaCursor then				metaCursor.state := 'resident;			theEntry		end,		Next: func()			:Mover('Next),		Prev: func()			:Mover('Prev),		Entry: func()			metaCursor.cursor:entry(),		Reset: func()			begin			foreach curs in curses do			begin				curs.cursor:Reset();				curs.state := 'passed;			end;			:Next()			end,		ResetToEnd: func()			begin			foreach curs in curses do				begin				curs.cursor:ResetToEnd();				curs.state := 'prior				end;			:Prev()			end,		Goto: func(arg1)			begin			local theEntry;			foreach curs in curses do			begin				local currEntry := curs.cursor:Goto(arg1);				curs.state := 'passed;				if currEntry				and (theEntry = nil or call comparator with (theEntry, currEntry, '|>|)) then					begin					metaCursor := curs;					theEntry := currEntry					end			end;			if metaCursor then				metaCursor.state := 'resident;			theEntry			end,		GotoKey: func(arg1)			begin			local theEntry;			foreach curs in curses do			begin				local currEntry := curs.cursor:GotoKey(arg1);				while currEntry = 'deleted do					currEntry := curs.cursor:Next();				curs.state := 'passed;				if currEntry				and (theEntry = nil or call comparator with (theEntry, currEntry, '|>|)) then					begin					metaCursor := curs;					theEntry := currEntry					end			end;			if metaCursor then				metaCursor.state := 'resident;			theEntry			end,		Move: func(count)			begin			if count > 0 then				while count > 0 do					begin					count := count - 1;					:Next();					end			else				while count < 0 do					begin					count := count + 1;					:Prev()					end;			:Entry()			end,		CountEntries: func()			begin			local count := 0;			for i := 0 to finalCurse - 1 do				count := count + curses[i].cursor:CountEntries();			count			end	},/*------------------------------------------------------------------------------	@104			Simple display font.*/	{  name: "Simple", 		fontName: "Geneva",	// not original, obviously		encoding: 0, 		macFontID: 3, 		screenSym: 'genevaFont, 		psName: 'helvetica, 		psScale: 72089, 		badFontMap: 1, 		plainData: nil, 		boldData: nil, 		italicData: nil, 		boldItalicData: nil, 		userSizes: [9, 10, 12, 18], 		usable: true, 		tsID: 2	},/*------------------------------------------------------------------------------	@105			Array of six pen images, different orientations.*/	[		{			mask: MakeBinaryFromHex("00000000000400090009017A00280194000003C000000FC000003FC000007FC00000FFC00000FF800001FF800003FF800007FF00000FFE00000FFE00001FFC00003FF800007FF00000FFF00000FFE00001FFC00003FFC00007FF80000FFF00001FFE00001FFC00003FFC00007FF80000FFF00000FFE00000FFE00000FFC00000FF8000007F0000003E000000", 'mask),			bits: MakeBinaryFromHex("00000000000400080008015C0027017600000000000001800000078000001D8000003F0000006F0000004F0000009E0000013C0000033C00000678000004F0000009E0000013E0000037C00000678000004F8000009F0000013E0000033C0000067800000CF8000008F000001DE000003FC0000067C00000478000004F0000003E0000001C00000000000000", 'bits),			bounds: SetBounds(0, 0, 26, 31)		},		{			mask: MakeBinaryFromHex("000000000004000B000B01A9002501C83E0000007F000000FF800000FFE00000FFF00000FFF80000FFFC00007FFE00003FFF80001FFFC0000FFFE00003FFF00001FFFC0000FFFE00003FFF00001FFF80000FFFE00007FFF00001FFF80000FFF800003FFC00001FFC00000FFE000003FE000001FE0000003E", 'mask),			bits: MakeBinaryFromHex("000000000004000A000A01D8002401F7000000001C000000260000006300000073C000007F6000003E3000001F1800000FC4000007E3000001F9800000FCC000007E2000001F9800000FCC000007E6000003F1000000F8C000007E6000001F3000000FF0000007F8000001E8000000FC0000001C00000000", 'bits),			bounds: SetBounds(0, 0, 31, 26)		},		{			mask: MakeBinaryFromHex("000000000004000B000B01E400250203000000F8000001FC000003FE00000FFE00001FFE00003FFE00007FFE0000FFFC0003FFF80007FFF0000FFFE0001FFF80007FFF0000FFFE0001FFF80003FFF0000FFFE0001FFFC0003FFF00003FFE00007FF800007FF00000FFE00000FF800000FF000000F8000000", 'mask),			bits: MakeBinaryFromHex("000000000004000B000B01E4002502030000000000000070000000C80000018C0000079C00000DFC000018F8000031F0000047E000018FC000033F0000067E000008FC000033F0000067E00000CFC000011F8000063E00000CFC000019F000001FE000003FC000002F0000007E0000007000000000000000", 'bits),			bounds: SetBounds(0, 0, 31, 26)		},		{			mask: MakeBinaryFromHex("00000000000400090009021D002B022B01F8000001FC000003FC000003FC000007FC000007FC000007FC000007F800000FF800000FF000000FF000000FF000001FF000001FE000001FE000001FE000003FC000003FC000003FC000003FC000007F8000007F8000007F800000FF800000FF000000FF000000FF000000FE000000FE000000FE000000FC000000F8000000F8000000F0000000", 'mask),			bits: MakeBinaryFromHex("00000000000400090009021D002B022B0000000000F0000000B8000001B8000001F8000003F800000370000003700000036000000660000006E0000006E0000004C000000DC000000DC000000D800000098000001B8000001B8000001B0000001700000037000000370000002E0000004E0000006E0000007C0000007C0000006C0000005800000070000000700000006000000000000000", 'bits),			bounds: SetBounds(0, 0, 14, 34)		},		{			mask: MakeBinaryFromHex("000000000004001E001E024F003D0269F0000000FC000000FF000000FF800000FFC000007FC000007FE000007FF000003FF800001FFC00001FFC00000FFE000007FF000003FF800003FFC00001FFC00000FFE00000FFF000007FF800003FFC00001FFE00000FFE00000FFF000007FF800003FFC00001FFC00001FFC00000FFC000007FC000003F8000001F00", 'mask),			bits: MakeBinaryFromHex("000000000004001E001E024F003D02690000000060000000780000006E0000003F0000003D8000003C8000001E4000000F2000000F3000000798000003C8000001E4000001F2000000FB000000798000007C8000003E4000001F2000000F3000000798000007CC000003C4000001EE000000FF000000F9800000788000003C8000001F0000000E0000000000", 'bits),			bounds: SetBounds(0, 0, 26, 31)		},		{			mask: MakeBinaryFromHex("00000000000400410041023700630245F0000000F8000000F8000000FC000000FE000000FE000000FE000000FF000000FF000000FF000000FF8000007F8000007F8000007F8000003FC000003FC000003FC000003FC000001FE000001FE000001FE000001FF000000FF000000FF000000FF000000FF8000007F8000007F8000007FC000007FC000003FC000003FC000003FC000001F00000", 'mask),			bits: MakeBinaryFromHex("0000000000040041004102370063024500000000600000007000000070000000580000006C0000007C0000007C000000660000004600000026000000330000003300000013000000190000001980000019800000088000000C8000000CC000000CC0000004400000066000000660000006600000032000000330000003F0000003B0000001D8000001D8000001F8000000E0000000000000", 'bits),			bounds: SetBounds(0, 0, 14, 34)		}	],/*------------------------------------------------------------------------------	@106			Array containing nil element.*/	[ nil ],/*------------------------------------------------------------------------------	@107	newtPrefsView*/	{	_proto: protoDragger,		viewBounds: SetBounds(0, 0, 200, 60),		viewJustify: vjParentCenterH + vjParentCenterV,		ReOrientToScreen: ROM_DefRotateFunc,		theApp: nil,		viewChildren: [ viewChildren: 			{	_proto: protoTitle,				title: nil,				viewSetupFormScript: func()					begin					title := ParamStr("^0 Preferences", [theApp.title]);					inherited:viewSetupFormScript()					end			},			{	_proto: protoCheckbox,				viewBounds: SetBounds(16, -32, 196, -17),				viewJustify: vjParentBottomV,				text: nil,				viewSetupFormScript: func()					begin					viewValue := (theApp:GetAppPreferences()).internalStore;					text := ParamStr("Always store new ^0 internally", [Downcase(Clone(theApp.appObject[1]))])					end,				viewQuitScript: func()					begin					if theApp.prefsCache then						theApp.prefsCache.internalStore := viewValue					end			},			{	_proto: protoClosebox,				buttonClickScript: func()					begin					AddDeferredSend(theApp, 'RememberedClose, [base])					end			}		],		viewSetupFormScript: func()			begin			SetKeyView(self, 0)			end	},/*------------------------------------------------------------------------------	@108	protoYearPicker*/	{  viewClass: clPictureView,		viewFlags: vVisible,		viewFormat: nil,		viewBounds: SetBounds(20, 51, 104, 79),		viewJustify: vjLeftH + vjTopV,		declareSelf: 'digitBase,		minValue: 1904,		maxValue: 2922,		icon: nil,		viewChildren: [ viewChildren: 			kYearDigit,			kDecadeDigit,			kCenturyDigit		],		years: nil,		decades: nil,		centuries: nil,		allocateContext: [			'years, kYearDigit,			'decades, kDecadeDigit,			'centuries, kCenturyDigit		],		viewSetupFormScript: func()			begin			if value = 2920 then				SetValue(self, 'viewFlags, 0)			end,		SetYear: func(inYear)			begin			if value <> inYear then				begin				value := inYear;				years:Update();				decades:Update();				centuries:Update()				end			end	},/*------------------------------------------------------------------------------	@109			Helvetica PS font.*/	{  name: "Helvetica",		encoding: 0,		macFontID: 21,		psSym: 'helveticaFont,		normal: "Helvetica",		bold: "Helvetica-Bold",		italic: "Helvetica-Oblique",		bolditalic: "Helvetica-BoldOblique",		plainData: MakeBinaryFromHex("", 'sfnt),		boldData: MakeBinaryFromHex("", 'sfnt),		italicData: MakeBinaryFromHex("", 'sfnt),		boldItalicData: MakeBinaryFromHex("", 'sfnt)	},/*------------------------------------------------------------------------------	@110	ROM_hiliteSound*/	{	sndFrameType: 'codec,		codecName: "TDTMFCodec",		dataType: 16,		bufferSize: 6400,		bufferCount: 4,		compressionType: 6,		samplingRate: 21600,		samples: MakeBinaryFromHex("0001000400000000000409C40000332C0000000000960001009579180000000600002B5C000000000000012C0000000000000007000000C8000000000000012C00000000000000080000006E000000000000012C000000000000", 'samples)	},/*------------------------------------------------------------------------------	@111	ROM_inboxSoupName*/	"Inbox",/*------------------------------------------------------------------------------	@112	SYS_classes*/	{	phone: 'string,		homePhone: 'phone,		workPhone: 'phone,		faxPhone: 'phone,		otherPhone: 'phone,		carPhone: 'phone,		beeperPhone: 'phone,		mobilePhone: 'phone,		homefaxPhone: 'phone,		company: 'string,		address: 'string,		title: 'string,		name: 'string	},/*------------------------------------------------------------------------------	@113			DSExceptions -- months that are also girls’ names?*/	[ "may", "june", "april", "jan" ],/*------------------------------------------------------------------------------	@114			In/Out Box soup indices.*/	[	{ structure: 'multiSlot, path: '[category,timestamp], type: '[symbol,int], order: '[ascending,ascending] },		{ structure: 'multiSlot, path: '[state,timestamp], type: '[symbol,int], order: '[ascending,ascending] },		{ structure: 'slot, path: 'xlabels, type: 'tags, tags: '[_new] },		{ structure: 'slot, path: 'timestamp, type: 'int, order: 'ascending }	],/*------------------------------------------------------------------------------	@115*/	"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",/*------------------------------------------------------------------------------	@116*/	{ type: 'index, indexPath: 'tag, startKey: "LetterWeights2.0", validTest: func(e) StrEqual(e.tag, "LetterWeights2.0") },/*------------------------------------------------------------------------------	@117				inker calibration function*/	func()	begin	local calibInfo := call func()		begin		local internalStore := GetStores()[0];		if internalStore:HasSoup(ROM_systemSoupName) then			begin			local sysSoup := internalStore:GetSoup(ROM_systemSoupName);			local calibrationEntry := sysSoup:Query({type: 'index, indexPath: 'tag, beginKey: "Calibration", endKey: "Calibration"}):Entry();			if calibrationEntry and IsTabletCalibrationNeeded() then				begin				calibrationEntry.rotated := Array(4, nil);				EntryChange(calibrationEntry)				end			end;		calibrationEntry		end with ();	if calibInfo and calibInfo.data then		begin		SetCalibration(calibInfo.data);		true		end	end,/*------------------------------------------------------------------------------	@118	userConfiguration setup*/	func()	begin	local internalStore := GetStores()[0];	local sysSoup := internalStore:GetSoup(ROM_systemSoupName);	local userConfig;	if sysSoup then		userConfig := sysSoup:Query({indexPath: 'tag, beginKey: "userConfiguration", endKey: "userConfiguration"}):Entry();	if not userConfig then		begin		DefGlobalVar('userConfiguration, {_proto: @285, tag: "userConfiguration", lcdContrast: GetLCDContrast()});		SetSortID(GetUserConfig('sortId))		end	else		begin		userConfig._proto := @285;		DefGlobalVar('userConfiguration, userConfig)		end;	if not sysSoup then		sysSoup := internalStore:CreateSoup(ROM_systemSoupName, @275);/*	if not userConfig then		sysSoup:Add(userConfiguration);*/	SetLCDContrast(GetUserConfig('lcdContrast));	SetSystemVolume(GetUserConfig('soundVolumeDb));	nil	end,/*------------------------------------------------------------------------------	@119*/	func()	begin	local entry, isLetterWeightSet;	if userConfiguration.letterSetSelection <> 2 then		begin		entry := GetTaggedEntry("LetterWeights2.0");		if entry and entry.data then			begin			SetLetterWeights(entry.data);			isLetterWeightSet := true			end;		if userConfiguration.bigLearningEnabled then			begin			entry := GetTaggedEntry("LearningData2.0");			if entry and entry.data then				SetLearningData(entry.data)			end		end;	isLetterWeightSet	end,/*------------------------------------------------------------------------------	@120			Mail editor.*/	{	_proto: protoFloatNGo,		preallocatedContext: 'mailEditor,		viewFlags: vApplication + vClipping + vFloating + vClickable + vStrokesAllowed,		viewBounds: nil,		titleBounds: SetBounds(18, 57, -18, 157),		fullBounds: SetBounds(18, 18, -18, -18),		viewJustify: vjParentFullH + vjParentFullV,		viewEffect: fxDrawerEffect,		ReOrientToScreen: ROM_DefRotateFunc,		appName: "",		path: nil,		message: nil,		updateScript: nil,		declareSelf: 'base,		_cacheContext:		{			_parent: nil,			_proto: nil,			viewCObject: nil,			viewFlags: vApplication + vClipping + vFloating + vClickable + vStrokesAllowed,			viewBounds: nil,			viewJustify: vjParentFullH + vjParentFullV,			viewclipper: nil,			appName: "",			path: nil,			message: nil,			updateScript: nil,			base: nil,			mailTitle: nil,			messageHolder: nil,			messageField: nil		},		stepChildren: [stepChildren: /*			kRef596F41,			kRef59783D*/		],		mailTitle: nil,		messageHolder: nil,		messageField: nil,		stepallocatecontext: [/*			'mailTitle, kRef596F41,			'messageHolder, kRef59783D,			'messageField, kRef597891*/		],		viewSetupFormScript: func()			begin			if path = 'title then				begin				viewJustify := vjParentFullH + vjParentCenterV;				viewBounds := titleBounds				end			else				begin				viewJustify := vjParentFullH + vjParentFullV;				viewBounds := fullBounds				end			end,		viewSetupChildrenScript: func()			begin			if path = 'title then				mailTitle.title := "Letter Subject"			end,		viewScrollUpScript: func()			begin			messageHolder:viewScrollUpScript()			end,		viewScrollDownScript: func()			begin			messageHolder:viewScrollDownScript()			end,		debug: 40020	},/*------------------------------------------------------------------------------	@121			eWorld account creation slip.*/	{},/*------------------------------------------------------------------------------	@122			eWorld mail transport.*/	{},/*------------------------------------------------------------------------------	@123  protoRepeatPicker*/	{	_proto: protoLabelPicker,		viewBounds: nil,		viewFont: 0x102400,		text: "Repeat",		labelCommands: [			"Don't repeat",			"Every day",			"Every week",			"Every other week",			"Every month",			"Same week each month",			"Every year",			"Same week each year",			"Other"		],		currentLabelIndex: nil,		meetingInstance: nil,		viewSetupFormScript: func()			begin			if selectedMeeting.repeatType then				begin				local datesApp := GetRoot().calendar;				local mtg := datesApp:FindException(originalMtgDate, selectedMeeting);				if mtg then					meetingInstance := mtg				else					meetingInstance := datesApp:MakeInstanceOfRepeatingMeeting(selectedMeeting, originalMtgDate)				end			else				meetingInstance := selectedMeeting;			repeatingView.meetingInstance := meetingInstance;			repeatingView.originalMtgDate := meetingInstance.mtgStartDate;			inherited:viewSetupFormScript()			end,		TextSetup: func()			begin			local template := meetingInstance.repeatTemplate;			if template then				begin				repeatingView.repeatType := template.repeatType;				repeatingView.mtgInfo := template.mtgInfo				end;			local index;			local mtgDate := Date(meetingInstance.mtgStartDate);			if template = nil then				index := 0			else if template.repeatType = 0 and template.mtgInfo = BOr(4064, 31) then				index := 1			else if template.repeatType = 0 and template.mtgInfo = BOr(2048 >> mtgDate.dayOfWeek, 31) then				index := 2			else if template.repeatType = 4 then				index := 3			else if template.repeatType = 2 then				index := 4			else if template.repeatType = 1 and template.mtgInfo = BOr(16 >> ((mtgDate.date - 1) div 7), 2048 >> mtgDate.dayOfWeek) then				index := 5			else if template.repeatType = 3 then				index := 6			else if template.repeatType = 7 then				index := 7			else				index := 8;			currentLabelIndex := index;			labelCommands[index]			end,		pickerSetup: func()			begin			if GetRoot().calendar:IsExceptionMeeting(meetingInstance) then				begin				:Notify(kNotifyAlert, if appSymbol												then GetAppName(appSymbol)												else "",											 if meetingInstance.viewStationery = 'cribNote												then "You cannot change the repeat frequency of an exception event."												else "You cannot change the repeat frequency of an exception meeting.");				:Hilite(nil);				nil				end			else				true			end,		labelActionScript: func(itemSelected)			begin			local mtgDate := Date(newMtgDate);			if itemSelected = 0 then				begin				repeatingView.repeatType := 5;				repeatingView.mtgInfo := 0				end			else if itemSelected = 1 then				begin				repeatingView.repeatType := 0;				repeatingView.mtgInfo := BOr(4064, 31)				end			else if itemSelected = 2 then				begin				repeatingView.repeatType := 0;				repeatingView.mtgInfo := BOr(2048 >> mtgDate.dayOfWeek, 31)				end			else if itemSelected = 3 then				begin				repeatingView.repeatType := 4;				repeatingView.mtgInfo := (newMtgDate div 1440) << 8 + 14				end			else if itemSelected = 4 then				begin				repeatingView.repeatType := 2;				repeatingView.mtgInfo := mtgDate.date				end			else if itemSelected = 5 then				begin				repeatingView.repeatType := 1;				repeatingView.mtgInfo := BOr(16 >> ((mtgDate.date - 1) div 7), 2048 >> mtgDate.dayOfWeek)				end			else if itemSelected = 6 then				begin				repeatingView.repeatType := 3;				repeatingView.mtgInfo := mtgDate.month << 8 + mtgDate.date				end			else if itemSelected = 7 then				begin				repeatingView.repeatType := 7;				repeatingView.mtgInfo := mtgDate.month << 12 + 2048 >> mtgDate.dayOfWeek + 16 >> ((mtgDate.date - 1) div 7)				end			else				repeatingView:Open();			currentLabelIndex := itemSelected			end	},/*------------------------------------------------------------------------------	@124  newtInfoButton*/	{	_proto: protoInfoButton,		boutView: nil,		prefView: nil,		DoInfoAbout: func()			begin			if boutView and boutView.viewCObject then				begin				newtAppBase:RememberedClose(boutView);				RemoveSlot(self, 'boutView)				end			else				begin				boutView := BuildContext(aboutView);				boutView.theApp := newtAppBase;				newtAppBase:RememberedOpen(boutView)				end			end,		DoInfoPrefs: func()			begin			if prefView and prefView.viewCObject then				begin				newtAppBase:RememberedClose(prefView);				RemoveSlot(self, 'prefView)				end			else				begin				prefView := BuildContext(prefsView);				prefView.theApp := newtAppBase;				newtAppBase:RememberedOpen(prefView)				end			end,		DoInfoHelp: func()			begin			local tinyTim := GetRoot().tinyTim;			if tinyTim and tinyTim.viewCObject then				tinyTim:Close()			else				begin				if newtAppBase.viewHelpTopic then					local topic := newtAppBase.viewHelpTopic;				if newtAppBase.helpManual then					begin					if topic then						tinyTim:OpenManualTo(newtAppBase.helpManual, topic)					else						tinyTim:OpenManual(newtAppBase.helpManual)					end				else if topic then					tinyTim:OpenHelpTo(topic)				else					tinyTim:Open()				end			end	},/*------------------------------------------------------------------------------	@125			Meeting slip?*/	{},/*------------------------------------------------------------------------------	@126			Meeting title.*/	"meeting",/*------------------------------------------------------------------------------	@127			Alert notification roll item.*/	{	_proto: protoRollItem,		viewFormat: vfNone,		viewBounds: SetBounds(0, 0, 0, 114),		viewJustify: vjParentFullH + vjSiblingBottomV,		height: 114,		viewChildren: [ viewChildren: 			{  _proto: protoStaticText,				viewFlags: vVisible + vReadOnly + vClickable,				viewBounds: SetBounds(0, 0, 0, 14),				viewJustify: vjParentFullH + vjParentTopV + vjOneLineOnly,				viewFont: ROM_fontSystem10Bold,				viewSetupFormScript: func()					begin					self.text := $\uFC05 & overview					end,				viewClickScript: func(unit)					begin					timeStampField:Open();					true					end			},			kTimeStampField,			{	_proto: protoStaticText,				viewJustify: vjParentFullH + vjParentFullV,				viewSetupFormScript: func()					begin					self.text := nfText;					self.viewBounds := SetBounds(0, 14, 0, 0)					end			}		],		timeStampField: nil,		allocateContext: [			'timeStampField, kTimeStampField		],	},/*------------------------------------------------------------------------------	@128  protoTimeButton*/	{	_proto: protoTextButton,		declareSelf: 'title,		lastSeed: nil,		viewSetupFormScript: func()			begin			text := :TimeString();			local box := :TimeBox(text);			if box then				viewBounds := box;			:SetupIdle(30000)			end,		viewIdleScript: func()			begin			local str := :TimeString();			local box := title:TimeBox(str);			if box then				SetValue(title, 'viewBounds, box);			SetValue(title, 'text, str);			30000			end,		viewDrawScript: func()			begin			inherited:?viewDrawScript();			if lastSeed <> vars.setTimeSeed then				begin				lastSeed := vars.setTimeSeed;				:viewIdleScript()				end			end,		TimeString: func()			begin			TimeStr(Time(), ROM_dateTimeStrSpecs.shortestTimeStrSpec) && ShortDate(nil)			end,		TimeBox: func(str)			begin			local box := viewBounds;			local width := StrFontWidth(str, viewFont);			if box.right - box.left <> width then				begin				box := Clone(box);				box.right := box.left + width;				box				end			end,		buttonClickScript: func()			begin			GetRoot().alarm:Toggle()			end	},/*------------------------------------------------------------------------------	@129	ROM_metaSoupName*/	"Directory",/*------------------------------------------------------------------------------	@130			Net Chooser.*/	{},/*------------------------------------------------------------------------------	@131			Fancy display font.*/	{  name: "Fancy", 		fontName: "NewYork",	// not original, obviously		encoding: 0, 		macFontID: 2, 		screenSym: 'newYorkFont, 		psName: 'timesroman, 		psScale: 75366, 		badFontMap: 1, 		plainData: nil, 		boldData: nil, 		italicData: nil, 		boldItalicData: nil, 		userSizes: [9, 10, 12, 18], 		usable: true, 		tsID: 1	},/*------------------------------------------------------------------------------	@132  protoDragger*/	{	_proto: @847,		viewFlags: vClickable,		viewFormat:  vfFillWhite + vfFrameDragger + vfPen(7) + vfInset(1) + vfRound(5),		viewBounds: SetBounds(10, 10, 200, 100),		declareSelf: 'base,		noScroll: "This application does not support scrolling",		noOverview: "This application does not support Overview",		beenThereDoneThat: nil,		viewSetupFormScript: func()			begin			local box := :?GlobalBox();			if box then				begin				local disp := displayParams;				if disp.appAreaGlobalLeft + disp.appAreaWidth < box.right				or disp.appAreaGlobalTop + disp.appAreaHeight < box.bottom				or disp.appAreaGlobalLeft > box.left				or disp.appAreaGlobalTop > box.top then					RemoveSlot(self, 'viewBounds)				end			end,		viewScrollUpScript: func()			begin			if not beenThereDoneThat then				begin				beenThereDoneThat := true;				:Notify(kNotifyAlert, "Up Arrow", noScroll)				end			end,		viewScrollDownScript: func()			begin			if not beenThereDoneThat then				begin				beenThereDoneThat := true;				:Notify(kNotifyAlert, "Down Arrow", noScroll)				end			end,		viewOverviewScript: func()			begin			:Notify(kNotifyAlert, "Overview", noOverview)			end,		viewClickScript: func(unit)			begin			if self = base and BAnd(viewFormat, 240) = 208 then				begin				local x := GetPoint(firstX, unit);				local y := GetPoint(firstY, unit);				local box := :GlobalBox();				if y - box.top < 10				and abs(x - (box.left + box.right) >> 1) < 10 then					begin					base:DragWindow(unit);					true					end				end			end,		DragWindow: func(unit)			begin			InkOff(unit);			Clicker();			local myParent := :Parent();			local withinBounds := if myParent = GetRoot() then				RelBounds(displayParams.appAreaGlobalLeft, displayParams.appAreaGlobalTop, displayParams.appAreaWidth, displayParams.appAreaHeight)			else				myParent:GlobalBox();			if not ViewContainsCaretView(self)			and CommandKeyboardConnected()			and not RestoreKeyView(self) then				begin				if self.defaultKeyViewName then					SetKeyView(self.(defaultKeyViewName), 0)				else if self.textFlags and BAnd(self.textFlags, 16384) <> 0 then					SetKeyView(self, 0)				end;			:MoveBehind(nil);			:Drag(unit, withinBounds);			:Dirty()			end	},/*------------------------------------------------------------------------------	@133			Note stationery.*/	{	_proto: newtEditView,		viewBounds: SetBounds(0, 0, 0, 0),		viewJustify: vjParentFullH + vjParentFullV,		viewFont: 0x4803,		name: "Note",		type: 'editor,		symbol: 'default,		protection: 'private,		version: 1,		path: 'data,		realData: nil,		viewSetupDoneScript: func()			begin			if KeyboardConnected() and BAnd(self.viewFlags, 130) = 0			and target and not target.data then				:PositionCaret(10, viewOriginY + viewLineSpacing, nil);			inherited:?viewSetupDoneScript()			end,		MinimalBounds: func(entry)			begin			local bounds;			if entry.data then				foreach para in entry.data do					bounds := UnionRect(bounds, para.viewBounds);			bounds			end,	},/*------------------------------------------------------------------------------	@134*/{	_proto: newtFalseEntryView,	viewFlags: vVisible + vClipping + vClickable,	viewBounds: SetBounds(0, 0, 0, 0),	viewJustify: vjParentFullH + vjParentFullV,	title: nil,	SetUpForm: func() nil,	TearDownForm: func() nil,	viewChildren: [ viewChildren: 		{	_proto: protoStaticText,			viewBounds: SetBounds(0, 0, 0, 30),			viewJustify: 0x800036,			text: nil,			viewSetupFormScript: func()				begin				text := title				end,			debug: "TitleLabel"		},		kNotesArea,		{			_proto: protoRecToggle,			viewBounds: SetBounds(5, -18, 23, -5),			viewJustify: vjCenterH + vjCenterV + vjParentBottomV,			viewSetupFormScript: func()				begin				if recTogOptions exists then					_recogPopup := recTogOptions;				inherited:?viewSetupFormScript()				end		},		{	_proto: protoLargeClosebox }	],	notesArea: nil,	allocateContext: [		'notesArea, kNotesArea	],	debug: 156619},/*------------------------------------------------------------------------------	@135				notification app.*/	GetLayout("notification"),/*------------------------------------------------------------------------------	@136				notify icon.*/	GetLayout("notifyIcon"),/*------------------------------------------------------------------------------	@137*/	[	"",		"Looking for modem",		"Connecting.",		"Connecting..",		"Connecting...",		"Connecting....",		"Receiving...",		"Disconnecting"	],/*------------------------------------------------------------------------------	@138			Newton software update slip.*/	{	_proto: protoFloater,		declareSelf: 'base,		viewBounds: SetBounds(0, 120, 200, 245),		viewChildren: [ viewChildren: 			{				_proto: protoStaticText,				viewBounds: SetBounds(10, 10, 190, 60),				viewJustify: 0,				text: "Enter the phone number of a provider of Newton updates."			},			kPhoneNum,			{	_proto: protoLargeClosebox },			{	_proto: protoTextButton,				viewBounds: SetBounds(-42, -18, -7, -5),				viewJustify: 0x800886,				text: "Call",				buttonClickScript: func()					begin					local number := phoneNum.entryLine.text;					number := StrToPhone(number);					base:Close();					AddDeferredSend(transport, 'ConnectNow, [number])					end,			}		],		phoneNum: nil,		allocateContext: [			'phoneNum, kPhoneNum		],		debug: 611997	},/*------------------------------------------------------------------------------	@139	ROM_outboxSoupName*/	"Outbox",/*------------------------------------------------------------------------------	@140*/	{  _proto: protoStaticText,		viewBounds: SetBounds(0, -20, 0, 0),		viewJustify: vjCenterH + vjTopV + vjParentFullH + vjParentBottomV,		viewFont: fancyFont9,		viewSetupFormScript: func()			begin			_pageTurner := self;			:TurnPage()			end,		TurnPage: func()			begin			self.text := "Page" && fields.pageNumber			end	},/*------------------------------------------------------------------------------	@141			Preview slip.*/	{  _proto: protoFloater,		viewBounds: SetBounds(8, 8, -8, -8),		viewJustify: vjParentFullH + vjParentFullV,		declareSelf: 'base,		ReOrientToScreen: ROM_DefRotateFunc,		fields: nil,		printView: nil,		viewChildren: [viewChildren: 			@679,			protoLargeClosebox,			kNextPageButton		],		_defaultButton: nil,		allocateContext: [			'_defaultButton, kNextPageButton		],		debug: "previewForm"	},/*------------------------------------------------------------------------------	@142*/	[	{ structure: 'slot, path: 'timestamp, type: 'int },		{ structure: 'slot, path: 'labels, type: 'tags }	],/*------------------------------------------------------------------------------	@143  newtFolderTab*/	{	_proto: protoNewFolderTab,		viewSetupFormScript: func()			begin			newtAppBase.filterBar := self;			inherited:?viewSetupFormScript()			end	},/*------------------------------------------------------------------------------	@144	ROM_paperRollSoupName*/	"Notes",/*------------------------------------------------------------------------------	@145*/	MakeBinaryFromHex("08D40119FF31004975308AD0000500040000000100040004000000030008000400000005000700040000000E000900040000000B000600040000000A000200050000001C0003000500000018000A000500000008000B00050000000C000D000500000007000100050000001D000C0005000000060000000600000024FFFE000600000034FFF900060000003F000F000600000030FFFF0006000000100010000600000036FFFC000600000009FFFD000600000019FFFB00060000002D001100060000000FFFFA00060000002F000E000600000000FFF7000700000039001300070000001200140007000000560012000700000054FFF600070000000DFFF800070000002200150008000000A0FFEC000800000017FFF5000800000042FFF00008000000E900170008000000E2FFEB0008000000A9FFED0008000000F7FFEF000800000077FFE70008000000B700180008000000D7FFE900080000005F0016000800000004FFF3000800000094FFF2000800000002FFF10008000000CDFFE5000800000079FFEA000800000037FFF4000800000014FFDE0009000001D2FFD2000900000097FFE000090000014D001A000900000152FFE60009000000C4FFD60009000001B2FFE10009000000D2001C0009000001DF0019000900000162FFE2000900000120FFDF000900000020FFEE000900000182FFE40009000000B2FFC900090000011FFFDC000900000197FFD0000900000169FFDA000900000069FFD9000900000057FFD8000900000029FFE8000900000084FFDD000900000196FFE3000900000096FFD7000900000016FFC0000A00000316FFCE000A000003E0FFCF000A000001E0FFBF000A00000129001E000A000000DFFFBB000A000000F9FFC1000A000001F9FFBC000A0000021FFFCB000A0000004DFFC8000A0000024DFFD5000A00000360001B000A00000160FFD1000A00000260FFD3000A00000060FFC5000A00000244001D000A00000144FFC2000A00000357FFC4000A00000157FFC6000A00000184FFCD000A000001C2FFC3000A000003C2FFDB000A00000282FFCC000A00000262FFCA000A00000052FFBD000A00000252FFC7000A00000044FFD4000A00000344FFBE000A000003F9FFB8000B00000116FFB3000B00000516FFB0000B000006E0FFB7000B000002E0FFA6000B0000009FFFB4000B00000729FFA9000B000004E0FFA1000B000002F9FF9C000B000006F9FFAC000B000000E0FFBA000B0000041FFFAA000B0000069FFFAD000B000000C2FFB2000B000002C20020000B00000784FFA8000B000003C4FFAF000B0000029F0022000B000006C2001F000B00000062FFB9000B00000082FFB5000B00000482FFB6000B00000462FFAB000B00000232FFA3000C000001C40024000C00000CC2FFA2000C000009C4FF95000C00000F72FF9A000C00000772FF8F000C00000B72002C000C00000372FFA4000C00000D72FFA7000C000005720028000C00000972FF9F000C00000172FFB1000C000005C40023000C00000DC4FF97000C000007C40037000C00000072FF78000C00000872FF8D000C00000472FF88000C00000C720021000C00000B84FFAE000C000003290025000C00000B29FF85000C00000FC4FFA5000C0000081FFF7F000C0000049FFF7A000C00000C9FFF99000C0000019FFF98000C0000099F002A000C0000059FFF9B000C00000D9FFF91000C0000039FFF83000C00000B9FFF93000C0000079FFF92000C00000F9F0029000C000002DFFF9D000C00000ADF0027000C000006DFFF9E000C00000EDFFF76000D00000432FF75000D00001432FF7B000D00000C32FF77000D00001C320038000D00001832FF87000D00000632FF86000D00001632002F000D00000E32FF8A000D00001E32FF33000D000001320035000D00000832FF7C000D00001032FF4C000D00000932FF47000D00001932FF7E000D00000032FF94000D000014C20026000D00000384FFA0000D00001384FF6E000D00000F32FF6C000D00001F32002D000D0000001FFF8E000D0000101F0041000D00000332FF70000D00001332003C000D00000B32003D000D00001B320047000D00000732FF5C000D00001732FF68000E00003FF20048000E00001FF2FF66000E00002FF2FF67000E00000FF2FF6A000E000037F20045000E000017F2FF69000E000027F20046000E000007F2FF60000E00003BF2FF61000E00001BF2FF5E000E00002BF2FF5F000E00000BF2FF64000E000033F2FF65000E000013F2FF62000E000023F2FF63000E000003F2FF73000E00003DF2003E000E00001DF2FF72000E00002DF2003F000E00000DF2FF79000E000035F2003A000E000015F2FF74000E000025F2003B000E000005F2FF6D000E000039F20043000E000019F2FF6B000E000029F20044000E000009F2FF71000E000031F20040000E000011F2FF6F000E000021F20042000E000001F2FF45000E00003EF2FF46000E00001EF2FF43000E00002EF2FF44000E00000EF2FF4A000E000036F2FF4B000E000016F2FF48000E000026F2FF49000E000006F2FF3D000E00003AF2FF3E000E00001AF2FF3B000E00002AF2FF3C000E00000AF2FF41000E000032F2FF42000E000012F2FF40000E000002F2FF57000E00003CF2FF58000E00001CF2FF55000E00002CF2FF56000E00000CF2FF5B000E000034F2FF5D000E000014F2FF59000E000024F2FF5A000E000004F2FF4F000E000038F2FF50000E000018F2FF4D000E000028F2FF53000E000030F2FF54000E000010F2FF51000E000020F2FF52000E000000F2FF89000E00003E720031000E00001E72FF84000E00002E720032000E00000E72FF8C000E00003672002E000E00001672FF8B000E000026720030000E00000672FF80000E00003A720036000E00001A72FF7D000E00002A720039000E00000A72FF82000E000032720033000E00001272FF81000E000022720034000E00000272FF35000E00003D32FF36000E00001D32FF32000E00002D32FF34000E00000D32FF39000E00003532FF3A000E00001532FF37000E00002532FF38000E000005327530000E000031328AD0000E00001132FF96000E000024C2FF4E000E000008F2FF3F000E000022F2FF90000F000044C2002B000F000004C2053400A5FF87002B75308AD0FFF7000400000009FFF9000400000005FFF8000400000001FFFB000400000007FFF600040000000FFFFA000400000003FFF4000500000002000200050000001EFFF200050000001BFFF300050000001DFFFD00050000001C0001000500000016FFFC000500000010FFFF000500000014000000050000001AFFFE00050000000AFFF50005000000180003000600000020000700060000002B000500060000002EFFEE000600000026FFF1000600000008FFF0000600000028FFED000600000006000400060000000CFFEF00060000002C000600060000002D00090007000000520008000700000064FFEA000700000024FFE900070000004E000A00070000000DFFE800070000000BFFEB000700000004FFEC000700000000FFE50008000000CB000C0008000000C0000B000800000040FFE7000800000092000E00080000000E000F0008000000CD000D0008000000C4FFE600080000008EFFE20009000000B20010000900000072FFE40009000001120011000900000032FFE3000900000172FFE1000A000000440012000A000001320013000A00000012FFDD000A0000034D0015000A000002440014000A0000004B0017000A0000024BFFDE000A000003F2FFDF000A0000014DFFE0000A0000024D0016000B0000044DFFDC000B000005440018000B000003440019000B0000054BFFD6000C00000744001E000C00000F440022000C00000B4B001C000C0000074BFFDA000C0000004DFFD8000C0000084DFFD7000C00000732001F000C00000144FFD2000C00000F32FFD1000C0000034BFFDB000C0000094B001B000C00000212FFD9000C00000A12FFD4000C00000612001A000C00000E120020000C00000F4B0029000D00001DF20026000D000001F2FFCA000D000011F2FFCE000D000009F20024000D000019F2FF89000D000005F2FFCC000D00000944FFD3000D0000014BFFD0000D0000114BFFC8000D00000DF2FFBC000E000018F2FFBB000E000038F2FFC6000E000004F2FFC5000E000024F2FFC7000E000014F2002A000E000034F2FFC2000E00000CF2FFC1000E00002CF2FFC4000E00001CF2FFC3000E00003CF2FFAE000E000002F2FFCB000E00001B32FFB0000E000012F2FFAF000E000032F2FFAA000E00000AF2FFA9000E00002AF2FFAC000E00001AF2FFB6000E000006F2FFB5000E000026F2FFB8000E000016F2FFB7000E000036F2FFB2000E00000EF2FFB1000E00002EF2FFB4000E00001EF2FFB3000E00003EF28AD0000E000015F27530000E000035F20028000E00002B32FFC9000E00000B320023000E00003332001D000E00003944FFAD000E000022F2FFCF000E000013320025000E00002332FFCD000E00000332FFB9000E000028F2FFBA000E000008F2FFBF000E000030F2FFC0000E000010F2FFBD000E000020F2FFBE000E000000F20027000E00003B32FF93000E00003FB2FF94000E00001FB2FF91000E00002FB2FF92000E00000FB2FF97000E000037B2FF98000E000017B2FF95000E000027B2FF96000E000007B2FF8B000E00003BB2FF8C000E00001BB2FF88000E00002BB2FF8A000E00000BB2FF8F000E000033B2FF90000E000013B2FF8D000E000023B2FF8E000E000003B2FFA3000E00003DB2FFA4000E00001DB2FFA1000E00002DB2FFA2000E00000DB2FFA7000E000035B2FFA8000E000015B2FFA5000E000025B2FFA6000E000005B2FF9B000E000039B2FF9C000E000019B2FF99000E000029B2FF9A000E000009B2FF9F000E000031B2FFA0000E000011B2FF9D000E000021B2FF9E000E000001B2FFAB000E00003AF2FFD5000F000019440021000F000059440374006DFFD1003D75308AD0FFFF00040000000D000300040000000B000000040000000A0001000400000006000600040000000F0002000400000005FFFC000500000013000C000500000019FFFD000500000009000B000500000001FFFE000500000012000A00050000000200090005000000140008000500000004000D000500000017000700050000000800040005000000100005000500000000000F00060000003C000E00060000001CFFFB000600000018FFF7000600000007FFF900060000000EFFFA00060000003800110006000000030010000600000031FFF800060000003EFFF600070000002C00140007000000110015000700000023001300070000006EFFF4000700000063001200070000000CFFF500070000005EFFF30008000000ECFFF00008000000E7FFF1000800000067FFF200080000001E001800080000009E00170008000000CC001600080000006C0019000800000027001B000900000051001C000900000151FFEF00090000012EFFEE0009000001D1001A00090000014C001D000A0000024CFFED000A0000022E001E000A000000AE001F000A000001AE0020000A000001A7FFEB000A000003A70024000B000004A7FFE8000B000004D10023000B000000D1FFE9000B000006D1FFEC000B0000004C0021000B0000044C0022000B000007AEFFEA000B0000042EFFE7000B000006A70025000B000000A70026000C0000002EFFE4000C000006AEFFE6000C000003AE0028000C00000BAEFFE2000D000002AEFFE0000D00001AA70027000D000012AE0029000D000012A7FFE3000D000002A7002A000D00001AAEFFE5000D00000AAEFFDE000E00002AA70030000E000032D1FFDF000E000012D1002D000E0000382EFFD6000E000002D1002B000E00003EAEFFDD000E0000182EFFE1000E00000EAEFFDB000E00002EAEFFD7000F0000082E003B000F0000482E002E000F00000AA7002F000F00004AA70033000F00006AD10032000F00002AD1FFD3000F00004AD10036000F00000AD1FFDC000F0000282E002C000F00005EAEFFDA000F0000682E003C00100000FAD1003A001000007AD18AD000100000BAD17530001000003AD1FFD200100000DAD10037001000005AD10039001000009AD10038001000001AD1FFD500100000E2D100340010000062D100350010000022D1FFD9001000009EAEFFD400100000A2D10031001100001EAEFFD8001100011EAE03CC0078FFC7003E75308AD0000100040000000AFFFF000400000006000000040000000C000300040000000F000200040000000DFFFE00040000000B0008000500000009FFFD00050000000400040005000000100005000500000018FFFB000500000019FFFC00050000000E000700050000001E0006000500000002FFFA0005000000070009000500000003FFF9000600000020FFF8000600000014000C000600000025FFF5000600000037000B000600000032FFF7000600000011000A000600000008FFF6000600000015000D000600000033000F000700000034FFF10007000000350011000700000052000E0007000000400014000700000075FFF40007000000280010000700000074FFF2000700000005FFF000070000005700130007000000310012000700000021FFF30007000000410018000800000061FFED0008000000E10017000800000071FFEC0008000000F1FFEE0008000000920019000800000013001A000800000093FFEA000800000053FFEB0008000000D30016000800000068FFEF0008000000800015000800000000001D000900000145FFE5000900000097FFE8000900000181FFE60009000001C5001C000900000081001E000900000017FFE90009000001E8001F000900000197FFE7000900000112001B000900000001FFE3000A000000C5FFE4000A00000012FFE2000A000001170020000A00000045FFDF000B000001010023000B000007010022000B000004E80021000B000000E8FFE1000B000002E80028000B00000317FFE0000B000006120024000B000002450027000C000003010025000C00000EE8002A000C000007170026000C00000645FFDD000C00000212FFDC000C00000A12FFDE000C00000501002C000C00000EC5FFDA000D000016E8FFDB000D000006E8FFD7000D00000F170029000D00001B01FFD9000D00001E45002B000D00000E45002D000E000032C5FFD6000E000012C5002F000E00002B01002E000E00000B010036000E000022C50030000E00001D010037000E00001F17FFD8000E00002D01FFD3000E000002C50031000E00003D010035000F000046C5FFCB000F00000AC5FFCD000F00006AC5FFCF000F00002AC5FFC9000F00004AC50039000F00007F170034000F000006C5FFD5000F00004D010032000F00000D01003A000F000076C50038000F000036C5FFD0000F000056C5003C000F000016C50033000F000066C5FFD4000F000026C5FFCE001000001AC5FFCC001000009AC5FFD2001000003F17003B00100000BF17003D00100000DAC57530001000003AC58AD000100000BAC5FFCA001000007AC5FFC800100000FAC5FFD1001000005AC5010C0020FFF2001175308AD000000002000000020001000300000004FFFF0003000000010002000300000005000400040000000BFFFD0004000000070003000400000008FFFE000400000000000500050000000FFFFC000500000003FFFB000600000013000600060000001F0007000700000073FFFA000700000033FFF900080000003F00080008000000BF00090009000000FFFFF800090000007F000A000A000001FFFFF7000A0000017FFFF6000B000007FF000C000B000003FF000B000B0000037F000D000D00001F7FFFF5000E0000077FFFF4000E0000277F000F000E00002F7F000E000E00000F7F7530000F0000177F8AD0000F0000577FFFF3000F0000777F0010000F0000377F014C0028FFEF001675308AD000000002000000010001000300000003FFFF000300000006FFFC00040000000700020004000000080003000400000002FFFD00040000000CFFFE000400000000FFFB00050000000A000500050000001A0004000500000004FFFA00050000001FFFF900060000002F000600060000000F0007000700000054FFF80007000000740008000800000034FFF70008000000B40009000900000114FFF6000900000094FFF5000A00000394000A000A00000194FFF4000B00000214000B000B00000014FFF3000C00000C14000C000C00000614000D000D00000E140010000E00003414FFF2000E00002414000E000E000004140014000F00003E14000F000F000054140012000F00001E140011001000001414FFF10010000094148AD000100000FE14FFF000100000DE147530001000007E140013001100005E140015001100015E1400EC001CFFF0000B75308AD00000000200000000FFFF000200000003FFFE0003000000010001000300000002FFFD0004000000050002000400000006000300050000000EFFFC00050000001E000400060000000DFFFB00060000002D000500070000001DFFFA00070000005D000600080000003DFFF90008000000BDFFF70009000001FDFFF800090000007D000700090000017DFFF6000B000000FD0008000B000004FDFFF5000C00000AFDFFF4000D00000EFDFFF2000D00001EFDFFF3000D000012FD0009000D000002FDFFF1000E000036FD7530000E000026FD8AD0000E000006FD000A000E000016FD0174002DFFEC001875308AD000000002000000000002000300000003FFFF0003000000010001000300000006FFFE000300000007000300040000000AFFFD00040000000D0004000500000012FFFC000500000015FFFB0006000000250005000600000002FFFA000700000045000600070000002200070008000000E2FFF90008000000850008000900000162FFF8000900000105FFF7000A000002620009000A00000205FFF6000B00000462FFF5000C00000005000A000C00000062000B000C00000C05000C000D00000805FFF3000E00001805FFF4000E00002862000D000E00000862FFF1000E00003805FFEE000F000074050011000F000034050016000F00001405FFF2000F00007862000E000F00003862FFF0000F00005862000F000F000018620010000F000044058AD000100000D4057530001000005405001400100000E4050013001000006405001700100000A4050015001000002405FFEF001000008405FFED0011000104050012001100000405", 'Comp),/*------------------------------------------------------------------------------	@146  newtCountrySymbolFilter*/	{  _proto: newtTextFilter,		recFlags: 513,		picker: func()			begin			protoLocationPopup:New({default: GetCountryEntry(GetUserConfig('currentCountry))[0], spots: ROM_countrySoupName, result: 'symbol}, :GlobalLabelBounds(), self)			end,		PathToText: func()			begin			local entry := GetCountryEntry(target.(path));			entry[0].name			end,		TextToPath: func(str)			begin			if not StrFilled(str) then				str			else				begin				local entry := GetCountryEntry(str);				entry[0].symbol				end			end	},/*------------------------------------------------------------------------------	@147  protoTimePopup*/	{	_proto: protoGeneralPopup,		viewBounds: SetBounds(0, 0, 135, 32),		stepChildren: [ stepChildren: 			{				_proto: protoDigitalClock,				viewFormat: 0,				viewBounds: SetBounds(2, 2, 121, 30),				viewSetupFormScript: func()					begin					increment := (:Parent()).increment					end			}		],		New: func(arg1, arg2, arg3, arg4)			begin			if not arg1 then				arg1 := Time();			local local1 := :Init();			local local2 := (if not arg1 then Time() else arg1) + arg2 div 2; // REDUNDANT, SURELY?			local1.time := local2 - local2 mod arg2;			local1.increment := arg2;			local1.context := arg4;			local1:popup(arg3)			end,		TimeChanged: func()			begin			context:?NewTime(time)			end,		Affirmative: func()			begin			context:?pickActionScript(time)			end	},/*------------------------------------------------------------------------------	@148  ROM_phoneText*/	{	phone: "Phone",		homePhone: "Home",		workPhone: "Work",		faxPhone: "Fax",		carPhone: "Car",		beeperPhone: "Beeper",		mobilePhone: "Mobile",		otherPhone: "Other"	},/*------------------------------------------------------------------------------	@149			Date find stuff.*/	{},/*------------------------------------------------------------------------------	@150  ROM_plinkBeep*/	{	sndFrameType: 'codec,		codecName: "TDTMFCodec",		dataType: 16,		bufferSize: 6400,		bufferCount: 4,		compressionType: 6,		samplingRate: 21600,		samples: MakeBinaryFromHex("0001000100000000000203E80000271000000001000A012C01907D00000004D10000000A000000000000000A000000000000", 'samples),		userName: "Xylo"	},/*------------------------------------------------------------------------------	@151*/	"Preparing\u2026",/*------------------------------------------------------------------------------	@152  newtAboutView*/	{	_proto: protoDragger,		viewBounds: SetBounds(0, 0, 200, 225),		viewJustify: vjParentCenterH + vjParentCenterV,		ReOrientToScreen: ROM_DefRotateFunc,		theApp: nil,		theSoups: nil,		creditPict: nil,		creditHeight: 0,		viewChildren: [ viewChildren: 			{	_proto: protoTitle,				title: nil,				viewSetupFormScript: func()					begin					title := theApp.title;					inherited:viewSetupFormScript()					end			},			{	_proto: protoLargeClosebox,				buttonClickScript: func()					begin					AddDeferredSend(theApp, 'RememberedClose, [base])					end			},			kAboutBasic,			kAboutCredits		],		basic: nil,		credits: nil,		allocateContext: [			'basic, kAboutBasic,			'credits, kAboutCredits		],		viewSetupFormScript: func()			begin			if not theSoups then				theSoups := foreach soup in theApp.allSoups collect					soup.theSoup;			if theApp.aboutInfo.credits then				:SetupIdle(8000);			SetKeyView(self, 0)			end,		viewIdleScript: func()			begin			basic:Close();			credits:Open()			end,		New: func(inApp, inSoups, inBounds)			begin			local aboutView := BuildContext(newtAboutView);			aboutView.theApp := inApp;			aboutView.theSoups := inSoups;			if inBounds then				aboutView.viewBounds := inBounds;			aboutView:Open();			aboutView			end	},/*------------------------------------------------------------------------------	@153  protoPrinterChooserButton*/	{},/*------------------------------------------------------------------------------	@154			Serial printer chooser.*/	{},/*------------------------------------------------------------------------------	@155*/	"Printing page ",/*------------------------------------------------------------------------------	@156			Print routing slip.*/	{	_proto: protoFullRouteSlip,		appSymbol: '|print:newton|,		bottomIndent: 29,		hideOtherCity: true,		stepChildren: [ stepChildren: 			kPrintChoose,			kPrintPreview		],		printChoose: nil,		_previewButton: nil,		stepallocatecontext: [			'printChoose, kPrintChoose,			'_previewButton, kPrintPreview		],		OwnerInfoChanged: func()			begin			local config := userConfiguration;			fields.fromTitle := config.currentFaxTitle;			printChoose:SyncView();			printChoose:RedoChildren();			fields.fromRef := config.currentPersona			end,		_previewKeyScript: func(arg1)			begin			PressButton(_previewButton)			end,		_keyCommands: [			{	char: $i,				modifiers: 0x02000000,				keyMessage: '_previewKeyScript,				name: "Preview",				category: "Viewing"			}		],		debug: 23370,	},/*------------------------------------------------------------------------------	@157  protoApp*/	{	_proto: @847,		viewFlags: vApplication,		viewFormat: vfFillWhite + vfFrameBlack + vfPen(1) + vfInset(1) + vfRound(5),		viewBounds: nil,		viewJustify: vjParentCenterH + vjParentTopV,		declareSelf: 'base,		viewChildren: [ viewChildren:			protoTitle,			protoStatus		],		debug: 11340	},/*------------------------------------------------------------------------------	@158			Book reader proto.*/{	_proto: protoFloater,	declareSelf: 'base,	viewFlags: vApplication + vClipping + vClickable,	viewJustify: 0,	viewFont: ROM_fontSystem9,	viewLineSpacing: 0,	version: 2,	title: "Digital Books",	target: { class: 'copperfield },	edgeDrawer: @78,	bookRef: nil,	cuPage: nil,	storyCard: nil,	pickItems: [ ],	viewSetupFormScript: func()		begin		cuPage := self;		SetKeyView(self, 0)		end,	RegisterBookRef: plainC.FRegisterBookRef /* funcPtr: 6979577, numArgs: 2 */,	UnregisterBookRef: plainC.FUnregisterBookRef /* funcPtr: 7025041, numArgs: 1 */,	AuthorData: plainC.FAuthorData /* funcPtr: 6957397, numArgs: 0 */,	BookData: func() if :CurrentBook() then :CurrentBook().data,	CurrentBook: plainC.FCurrentBook /* funcPtr: 6962672, numArgs: 0 */,	CurrentKiosk: plainC.FCurrentKiosk /* funcPtr: 6962673, numArgs: 0 */,	CurrentPage: plainC.FCurrentPage /* funcPtr: 6962674, numArgs: 0 */,	CountPages: plainC.FCountPages /* funcPtr: 6961630, numArgs: 0 */,	WhereIsBook: plainC.FWhereIsBook /* funcPtr: 6985922, numArgs: 1 */,	HiliteBlock: plainC.FHiliteBlock /* funcPtr: 6972175, numArgs: 3 */,	ZoomView: plainC.FZoomView /* funcPtr: 6985935, numArgs: 4 */,	InsertForm: func(arg1)		begin		:HideStoryCard();		if Visible(pageDialog) then			pageDialog:Close();		if Visible(pageNumberDialog) then			pageNumberDialog:Close();		:AddToContentArea(arg1)		end,	AddToContentArea: plainC.FAddToContentArea /* funcPtr: 6956349, numArgs: 1 */,	TurnToPage: plainC.FTurnToPage /* funcPtr: 6984865, numArgs: 1 */,	TurnToSubject: func(subj)		begin		:TurnToPage(:FindPageBySubject(subj))		end,	TurnToContent: plainC.FTurnToContent /* funcPtr: 6984864, numArgs: 2 */,	ShowStoryCard: func(arg1, arg2, arg3)		begin		if storyCard <> nil then			:HideStoryCard()		else			begin			theContent := :FindContentByValue(arg1, arg2, true);			if Length(theContent) <> 0 then				begin				local local1 := {_proto: @221, viewBounds: arg3};				local local2 := theContent[0].data;				if ClassOf(local2) = 'picture then					begin					local1.viewClass := 76;					local1.icon := local2					end				else					local1.text := local2;				if theContent[0].viewFont then					local1.viewFont := theContent[0].viewFont;				if theContent[0].styles then					local1.styles := theContent[0].styles;				if theContent[0].tabs then					local1.tabs := theContent[0].tabs;				if theContent[0].viewJustify then					local1.viewJustify := theContent[0].viewJustify				else if theContent[0].layout and BAnd(theContent[0].layout, 4) <> 0 then					local1.viewJustify := 2;				storyCard := :InsertForm(local1);				storyCard:Show()				end			end		end,	HideStoryCard: func()		begin		if storyCard <> nil then			begin			storyCard:Close();			storyCard := nil			end		end,	AppFindTargets: func()		begin		local library := :GetOnlineBooks();		result := foreach book in library collect			{ name: book.title, target: book.isbn }		end,	Find: func(arg1, arg2, arg3, arg4)		begin		if bookRef = nil then			begin			local library;			local selection := [];			if arg3 = 'globalFind then				library := :GetOnlineBooks()			else				library := [{isbn: self.isbn}];			if :CuFind(arg1, self, selection, arg3, arg4, library) then				foreach book in selection do					AddArraySlot(arg2, {_proto: kBookFinder, owner: self, title: book.title, findType: 'text, findWords: SplitString(arg1), items: book.items})			end		end,	FindTargeted: func(arg1, arg2, arg3, arg4, arg5)		begin		local selection := [];		if :CuFind(arg1, self, selection, arg3, arg4, [{isbn: arg5}]) then			foreach book in selection do				AddArraySlot(arg2, {_proto: kBookFinder, owner: self, title: book.title, findType: 'text, findWords: SplitString(arg1), items: book.items})		end,	CuFind: plainC.FCuFind /* funcPtr: 6962668, numArgs: 6 */,	FindPageBySubject: plainC.FFindPageBySubject /* funcPtr: 7023982, numArgs: 1 */,	FindPageByContent: plainC.FFindPageByContent /* funcPtr: 6967938, numArgs: 3 */,	FindPageByValue: plainC.FFindPageByValue /* funcPtr: 6967940, numArgs: 3 */,	FindContentBySlot: plainC.FFindContentBySlot /* funcPtr: 6966900, numArgs: 2 */,	FindContentByValue: plainC.FFindContentByValue /* funcPtr: 6966902, numArgs: 3 */,	ShowFoundItem: func(item)		begin		:OpenBook(item.isbn);		local pageNo;		local book := item.found;		if book.page then			pageNo := book.page		else			begin			pageNo := :FindPageByContent(book.item, book.char, book.bookSoup);			book.page := pageNo			end;		:TurnToPage(pageNo);		:HiliteBlock(book.item, book.char, book.len)		end,	debug: 22697},/*------------------------------------------------------------------------------	@159*/	{	_proto: protoPictureButton,		viewFormat: vfFillWhite + vfFrameBlack + vfPen(1),		viewJustify: vjCenterH + vjTopV,		viewLineSpacing: 0,		viewChildren: [ viewChildren:			{	viewClass: clParagraphView,				viewFlags: vVisible + vReadOnly,				viewFormat: vfNone,			//	viewTransferMode: 1,				viewBounds: SetBounds(0, -11, 0, 0),				viewJustify: vjCenterH + vjTopV + vjParentFullH + vjParentBottomV + vjOneLineOnly }		],		buttonClickScript: func()			begin			base:Close();			:TurnToPage(pageNumber)			end,		debug: 362739	},/*------------------------------------------------------------------------------	@160  protoBorder*/	{	viewClass: clView,		viewFlags: vvisible,		viewBounds: nil,		viewFormat: vfFillBlack,		debug: 90824	},/*------------------------------------------------------------------------------	@161*/	{	_proto: protoTitle,		viewJustify: vjLeftH + vjCenterV + vjParentFullH + vjParentBottomV,		viewSetupFormScript: func()			begin			if not titleHeight then				titleHeight := FontHeight(viewFont);			titleWidth := StrFontWidth(title, viewFont);			self.viewBounds := SetBounds(0, -titleHeight + 2, 0, 2)			end,		debug: 2904837	},/*------------------------------------------------------------------------------	@162  newtClockFolderTab*/	{	_proto: protoClockFolderTab,		viewSetupFormScript: func()			begin			newtAppBase.filterBar := self;			inherited:?viewSetupFormScript()			end	},/*------------------------------------------------------------------------------	@163  protoLargeClosebox*/	{	_proto: protoPictureButton,		viewBounds: SetBounds(-18, -18, -5, -5),		viewJustify: vjCenterH + vjCenterV + vjParentRightH + vjParentBottomV,		icon: ROM_cancelBitmap,		_closeBox: 'closeBox,		cool: nil,		viewSetupFormScript: func()			begin			local blessed1 := userConfiguration.blessedApp;			if blessed1			and GetRoot().(blessed1) = GetVariable(self, 'base)			and self.buttonClickScript = protoLargeClosebox.buttonClickScript			or cool then				begin				icon := nil;				viewBounds := Clone(viewBounds);				if BAnd(viewJustify, vjParentRightH) <> 0 then					viewBounds.left := viewBounds.right := 0				else					viewBounds.left := viewBounds.right;				viewFormat := vfNone				end			else if icon = nil then				begin				RemoveSlot(self, 'icon);				RemoveSlot(self, 'viewBounds);				RemoveSlot(self, 'viewFormat)				end			end,		buttonClickScript: func()			begin			if icon then				base:Close()			end	},/*------------------------------------------------------------------------------	@164  protoCheckbox*/	{	_proto: protoCheckboxIcon,		viewChildren: [ viewChildren: 			{	viewClass: clTextView,				viewFlags: vVisible + vReadOnly,				viewBounds: SetBounds(16, 0, 0, 0),				viewJustify: vjLeftH + vjCenterV + vjParentFullH + vjParentFullV + vjOneLineOnly }		]	},/*------------------------------------------------------------------------------	@165  protoCheckboxIcon*/	{	viewClass: clPictureView,		viewFlags: vVisible + vClickable,		viewFormat: vfNone,		viewJustify: vjLeftH + vjCenterV,		viewFont: ROM_fontSystem9,		viewValue: nil,		declareSelf: 'base,		buttonValue: true,		text: "",		icon: kCheckBoxOffBitmap,		offBitmap: kCheckBoxOffBitmap,		onBitmap: kCheckBoxOnBitmap,		viewSetupDoneScript: func()			begin			:UpdateBitmap()			end,		viewClickScript: func(unit)			begin			if :TrackHilite(unit) then				begin				:ToggleCheck();				:Hilite(nil);				end;			true			end,		viewChangedScript: func(inTag, inValue)			begin			if inTag = 'viewValue then				:ValueChanged()			end,		ToggleCheck: func()			begin			AddUndoAction('ToggleCheck, []);			if viewValue = nil then				viewValue := buttonValue			else				viewValue := nil;			:ValueChanged();			:UpdateBitmap()			end,		SetCheck: func(inValue)			begin			if viewValue <> inValue then				begin				viewValue := inValue and buttonValue;				:ValueChanged();				:UpdateBitmap()				end			end,		UpdateBitmap: func()			begin			if viewValue then				base.icon := onBitmap			else				base.icon := offBitmap;			base:Dirty()			end,		ValueChanged: func()			nil,		debug: 5800980	},/*------------------------------------------------------------------------------	@166  protoClosebox*/	{	_proto: protoLargeClosebox,		viewFormat: vfNone,		viewBounds: SetBounds(-14, -15, -1, -2),		viewJustify: vjParentRightH + vjParentBottomV,		icon: ROM_goAwayBitmap, // includes border		_defaultButtonBounds: SetBounds(0, 0, 13, 13),		viewSetupFormScript: func()			begin			inherited:?viewSetupFormScript();			self.viewFormat := vfNone			end,		debug: 362838	},/*------------------------------------------------------------------------------	@167*/	{	form: nil,		wordOffset: nil,		wordLength: nil	},/*------------------------------------------------------------------------------	@168			Corrector.*/	{},/*------------------------------------------------------------------------------	@169*/	{	_proto: @205,		RecalcRecognition: func()			ReadCursiveOptions()	},/*------------------------------------------------------------------------------	@170  protoDateExpandoDeprecated*/	{},/*------------------------------------------------------------------------------	@171			protoDictionary.*/	{		name: "Custom Dictionary",		dict: nil,		dictId: nil,		ROMdictId: nil,		reverseDictId: nil,		localDictSlot: nil,		localDictIdSlot: nil,		domainType: nil,		dictType: 0,		order: 0,		status: 1,		result: plainC.FAirusResult,		IsReadOnly: func() BAnd(:PrivateType(), 0x08) = 0,		PrivateType: plainC.FAirusDictionaryType,		GetName: func() name,		Initialize: func(arg1, arg2)			begin			if not SetContains([ 0, 1, 2, 4 ], arg2) then				Throw('|evt.ex.msg.dict|, "bad attrSize:" & " " & arg2);			local local1 := :PrivateNew(arg1, arg2);			if local1 < 0 then				Throw('|evt.ex.msg.dict|, SPrintObject(local1));			end,		PrivateNew: plainC.FAirusNew /* funcPtr: 6995429, numArgs: 2 */,		Dispose: plainC.FAirusDispose,		Register: plainC.FAirusRegisterDictionary,		Unregister: plainC.FAirusUnregisterDictionary,		IsRegistered: func() dictId exists and dictId,		Add: func(arg1) :AddWord(arg1.word, arg1.attribute),		AddWord: func(word, attribute)			begin			local wordCount, wordLimit;			if self.limit exists then				wordLimit := self.limit;			if self.count exists then				wordCount := self.count;			if wordCount and wordLimit and wordCount >= wordLimit then				begin				if cursors and Length(cursors) > 0 then					GetRoot():Notify(kNotifyAlert, "Word List", "The word was not added because the word list is getting too full.  Please remove some words and try again.");				return -15				end;			if BAnd(attribute, 192) then				begin				word := Clone(word);				:DecodeRecognitionWord(word, attribute);				attribute := BAnd(attribute, -193)				end;			local local3 := :PrivateAddWord(word, attribute);			if local3 = 0 and wordCount then				self.count := wordCount + 1;			return local3			end,		PrivateAddWord: plainC.FAirusAddWord/*word, attribute*/,		DeleteWord: func(word)			begin			local result := :PrivateDeleteWord(word);			if result = 0 and self.count exists then				begin				count := count - 1;				if count < 0 then					count := :Walk("", nil)				end;			return result			end,		PrivateDeleteWord: plainC.FAirusDeleteWord/*word*/,		DeletePrefix: plainC.FAirusDeletePrefix/*prefix*/,		LookupWord: plainC.FAirusLookupWord /* funcPtr: 6995428, numArgs: 2 */,		AddEncodedWord: func(word, arg2)			begin			local recWord := Clone(word);			local result := -13;			local local3 := :EncodeRecognitionWord(recWord);			if StrLen(recWord) > 0 then				result := :AddOneEncodedWord(recWord, local3, arg2);			result			end,		AddOneEncodedWord: func(word, arg2, arg3)			begin			local local2 := {};			local result := :LookupWord(word, local2);			if result = 2 or result = 3 then				begin				if arg3 and local2.attribute <> arg2 then					begin					local local4 := BAnd(local2.attribute, -193);					:ChangeAttribute(word, local4);					result := 0					end				end			else				result := :AddWord(word, arg2);			result			end,		DeleteEncodedWord: func(word)			begin			local recWord := Clone(word);			local result := -6;			local local3 := :EncodeRecognitionWordDiacritsOK(recWord);			if StrLen(recWord) > 0 then				result := :DeleteWord(recWord);			return result			end,		LookupEncodedWord: func(word)			begin			local result := :LookupWord(word, nil);			if result = -6 or result = 1 then				begin				local recWord := Clone(word);				:EncodeRecognitionWordDiacritsOK(recWord);				if StrLen(recWord) > 0 then					begin					if StrExactCompare(Upcase(Clone(word)), word) = 0 then						begin						result := :LookupWord(Capitalize(Downcase(Clone(recWord))), nil);						if result = -6 or result = 1 then							result := :LookupWord(Downcase(Clone(recWord)), nil)						end					else if StrExactCompare(Capitalize(Downcase(Clone(word))), word) = 0 then						result := :LookupWord(Downcase(Clone(recWord)), nil)					end				end;			result			end,		Walk: plainC.FAirusWalkDictionary /* funcPtr: 6995433, numArgs: 2 */,		AttributeSize: plainC.FAirusAttributeSize,		ChangeAttribute: plainC.FAirusChangeAttribute /* funcPtr: 6994392, numArgs: 2 */,		EncodeRecognitionWord: func(word)			begin			return StripRecognitionWord(word)			end,		EncodeRecognitionWordDiacritsOK: func(word)			begin			return StripRecognitionWordDiacritsOK(word)			end,		DecodeRecognitionWord: func(word, attributes)			begin			if BAnd(attributes, 0x80) <> 0 then				Capitalize(word);			if BAnd(attributes, 0x40) <> 0 then				Upcase(word);			return word			end,		cursors: nil,		MakeCursor: func(arg1, arg2, arg3)			begin			local cursor := :AllocateCursor();			cursor:Initialize(arg1, arg2, arg3);			cursor			end,		AllocateCursor: plainC.FAllocateCursor,		Query: func(arg1) :MakeCursor(arg1.prefix, arg1.pin, arg1.loc),		protoDictionaryCursor: @345,		protoQuery: @345,		AddIndex: func(arg) nil,		RemoveIndex: func(arg) nil,		Flush: func() nil,		RealSoup: func() nil,		EntryStore: func(arg) nil,		EntryRemoveable: func() :IsReadOnly(),		EntryReadOnly: func(arg) true,		EntryRemoveFromSoup: func(arg1) :RemoveWord(arg1.word),		AddToDefaultStore: func(arg1) :Add(arg1)	},/*------------------------------------------------------------------------------	@172  protoDivider*/	{  viewClass: clView,		viewFlags: vVisible + vReadOnly,		viewFormat: vfNone,		viewBounds: nil,		viewJustify: vjParentFullH + vjParentTopV,		viewFont: ROM_fontSystem9Bold,		titleWidth: nil,		titleHeight: nil,		viewSetupChildrenScript: func()			begin			if not titleHeight then				titleHeight := FontHeight(viewFont);			titleWidth := StrFontWidth(title, viewFont) + 6;			divider.viewBounds := SetBounds(0, titleHeight div 2 - 1, 0, titleHeight div 2 + 2);			dividerText.text := title;			dividerText.viewBounds := RelBounds(16, 0, titleWidth, titleHeight)			end,		viewChildren: [ viewChildren: 			kDivider,			kDividerText		],		divider: nil,		dividerText: nil,		allocateContext: [			'divider, kDivider,			'dividerText, kDividerText		],		debug: 181408	},/*------------------------------------------------------------------------------	@173  protoDrawer*/	{	_proto: @847,		viewFlags: vApplication + vFloating,		viewFormat: vfFrameBlack + vfPen(3),		viewBounds: nil,		viewEffect: fxDrawerEffect,		showSound: ROM_drawerOpen,		hideSound: ROM_drawerClose,	},/*------------------------------------------------------------------------------	@174			Endpoint?*/	{},/*------------------------------------------------------------------------------	@175			Expando.*/	{},/*------------------------------------------------------------------------------	@176  protoFilingButton*/	{  _proto: protoPictureButton,		viewJustify: vjCenterH + vjCenterV + vjSiblingLeftH,		icon: nil,		iconInt: @711,		iconExt: @712,		viewSetupFormScript: func()			begin			icon := :PickIcon()			end,		PickIcon: func()			begin			local info := :GetTargetInfo('filing);			if not info or not info.targetStore or info.targetStore = GetStores()[0] then				iconInt			else				iconExt			end,		buttonClickScript: func()			begin			local info := :GetTargetInfo('filing);			filingSlip:OpenForUser(self, info,  GetVariable(info.targetView, 'doCardRouting),															GetVariable(info.targetView, 'dontStartWithFolder))			end,		Update: func()			begin			local myIcon := :PickIcon();			if icon <> myIcon then				SetValue(self, 'icon, myIcon)			end	},/*------------------------------------------------------------------------------	@177*/	{	_proto: protoRollItem,		viewSetupFormScript: func()			begin			text := title := StrTruncate(Clone(title), 132);			if skip <> 0 then				text := text & $\u2026			end	},/*------------------------------------------------------------------------------	@178			Find roll item.*/{	_proto: protoRollItem,	viewJustify: 0x802034,	viewChildren: [ 		{			_proto: protoStaticText,			viewBounds: SetBounds(15, 0, 0, 15),			viewJustify: 0x800030,			viewFont: ROM_fontSystem9,			viewSetupFormScript: func()				begin				self.text := title				end		}	],	Click: func()		begin		findDrawer:HideOtherApps(self.finder.owner);		AddDeferredSend(self, 'CloseFindAll, nil);		findDrawer:ShowItem(self.finder, self)		end,	CloseFindAll: func()		begin		findOverview:Close()		end},/*------------------------------------------------------------------------------	@179  protoFloater*/	{	_proto: protoDragger,		viewFlags: vFloating + vClickable,		viewJustify: vjParentCenterH + vjParentTopV,		viewEffect: fxZoomOpenEffect,		debug: 181520	},/*------------------------------------------------------------------------------	@180  protoFloatNGo*/	{	_proto: protoFloater,		viewChildren: [ viewChildren: protoClosebox ],		debug: 363081	},/*------------------------------------------------------------------------------	@181*/	{	_proto: newtPhoneFilter,		PathQuery: func(arg1)			begin			Query(GetUnionSoup(ROM_cardfileSoupName), {type: 'words, words: arg1})			end,		QueryItem: func(arg1, arg2)			begin			local local1, local2;			if arg1.phones then				begin				local1 := FindStringInFrame(arg1.phones, arg2, true);				if local1 then					begin					local2 := arg1.phones[local1[1]];					{item: ParamStr("^0 ^?1(^1)||", [MakeDisplayPhone(local2), PhoneTypes.phoneText.(ClassOf(local2))]), id: MakeEntryAlias(arg1)}					end				end			end,		ResolveItem: func(arg1)			begin			targetView:jamFromEntry(ResolveEntryAlias(arg1.id))			end	},/*------------------------------------------------------------------------------	@182  protoGauge*/	{  viewClass: clGaugeView,		viewFlags: vVisible + vReadOnly,		viewFormat: vfNone,		viewBounds: nil,		gaugeDrawLimits: true,		minValue: 0,		maxValue: 100,		viewValue: nil,		viewSetupFormScript: func()			begin			self.viewValue := vars.(valuePath)			end,		debug: 45415	},/*------------------------------------------------------------------------------	@183	protoGlance*/	{	viewClass: clTextView,		viewFlags: vReadOnly + vClickable,		viewFormat: vfFillWhite + vfFrameBlack + vfPen(2) + vfInset(1),		viewBounds: nil,		viewJustify: vjLeftH + vjCenterV,		viewEffect: fxMoveH + fxRevealLine,		viewFont: ROM_fontSystem9Bold,		textFlags: 0x8400,		viewIdleFrequency: 3000,		viewSetupDoneScript: func()			begin			:SetPopup();			:SetupIdle(viewIdleFrequency);			SetKeyView(self, 0)			end,		viewIdleScript: func()			begin			:Close()			end,		viewKeyDownScript: func(char, flags)			begin			if char <> $\00 then				begin				Clicker();				:Close();				true				end			end,		viewClickScript: func(unit)			begin			:Close()			end,		debug: 90867	},/*------------------------------------------------------------------------------	@184*/	"\u00A9\u2004 Newton Research Group.",/*------------------------------------------------------------------------------	@185	protoInputLine*/	{	viewClass: clParagraphView,		viewFlags: vVisible + vClickable + vGesturesAllowed + vCharsAllowed + vNumbersAllowed,		viewFormat: vfLinesGray,		viewBounds: nil,		viewJustify: vjOneLineOnly,		viewFont: tsHWFont + tsSize(12) + tsPlain,		viewLineSpacing: 20,		textFlags: 0x8,	// vFixedTextStyle	//	viewTransferMode: 1,		styles: nil,		tabs: nil,		text: nil,		viewSetupFormScript: func()			begin			if :Parent().viewLineSpacing exists then				self.viewLineSpacing := (:Parent()).viewLineSpacing			end,		viewSetupDoneScript: func()			begin			if text = nil then				text := ""			end,		debug: 728989	},/*------------------------------------------------------------------------------	@186			Empty frame.*/	{ },/*------------------------------------------------------------------------------	@187  protoKeyboard*/	{	_proto: protoFloater,		viewBounds: nil,		saveBounds: nil,		textFlags: nil,		freeze: nil,		firstTime: true,		viewSetupFormScript: func()			begin			if firstTime then				self.viewBounds := Clone(saveBounds);			local box := :GlobalBox();			local caretBox := GetCaretBox();			if not freeze and firstTime			and caretBox			and box.top < caretBox.bottom			and box.bottom > caretBox.top then				begin				local clearCaretDistance := caretBox.top - box.bottom - 32;				if box.top + clearCaretDistance > 8 then					viewBounds := OffsetRect(viewBounds, 0, clearCaretDistance);				end;			if currentKeyboard and currentKeyboard <> self then				currentKeyboard:Close();			currentKeyboard := self;			firstTime := nil			end,		viewQuitScript: func()			begin			if currentKeyboard = self then				currentKeyboard := nil;			firstTime := true			end,		debug: 363708	},/*------------------------------------------------------------------------------	@188  protoKeypad*/	{	viewClass: 0x4F,		viewFlags: vVisible + vClickable,		viewFormat: vfFillWhite,		viewFont: 0x102800,		keyArrayIndex: 0,		keyHighlightKeys: nil,		keyResultsAreKeycodes: true,		keyReceiverView: 'viewfrontkey,		keySound: ROM_typewriter,		keyDefinitions: nil,		viewSetupFormScript: func() :RegisterOpenKeyboard(5),		viewQuitScript:		func() :UnregisterOpenKeyboard()	},/*------------------------------------------------------------------------------	@189  protoLabelInputLine*/	GetLayout("protoLabelInputLine"),/*------------------------------------------------------------------------------	@190  protoLabelPicker*/	GetLayout("protoLabelPicker"),/*------------------------------------------------------------------------------	@191  protoOverview*/	{},/*------------------------------------------------------------------------------	@192			PIN entry slip.*/	GetLayout("PINEntrySlip"),/*------------------------------------------------------------------------------	@193			stdForm para*/	{  viewClass: 65617,		// clParagraphView + vcData		viewFlags: vVisible + vCalculateBounds + vNoScripts,		viewFormat: vfNone,		viewJustify: vjLeftH + vjTopV,		viewFont: tsHWFont + tsSize(18) + tsPlain,	//	viewTransferMode: 1,		textFlags: 4,  // vWidthGrowsWithText		text: nil,		styles: nil,		tabs: nil,		debug: 21708	},/*------------------------------------------------------------------------------	@194  protoPhoneExpandoDeprecated*/	{},/*------------------------------------------------------------------------------	@195  protoPicker*/	GetLayout("protoPicker"),/*------------------------------------------------------------------------------	@196  protoPictIndexer*/	{},/*------------------------------------------------------------------------------	@197  protoPictRadioButton*/	{	_proto: protoPictureButton,		declareSelf: 'base,		viewValue: nil,		buttonValue: nil,		viewClickScript: func(unit)			begin			if viewValue = nil then				cluster:SetCluster(base);			true			end,		viewDrawScript: func()			begin			if viewValue then				:DrawShape(MakeRect(1, 1, 14, 14), nil)			end,		UpdateBitmap: func()			begin			base:Dirty()			end,		debug: 46168208	},/*------------------------------------------------------------------------------	@198	protoPictureButton*/	{	viewClass: clPictureView,		viewFlags: vVisible + vReadOnly + vClickable,		viewFormat: vfFillWhite + vfFrameBlack + vfPen(2) + vfRound(4),		viewBounds: nil,		viewJustify: vjCenterH + vjCenterV,		viewClickScript: func(unit)			begin			if :TrackHilite(unit) then				begin				:buttonClickScript();				:Hilite(nil)				end;			true			end,		buttonClickScript: func()			nil,		debug: 11538576	},/*------------------------------------------------------------------------------	@199			stdForm poly*/	{  viewClass: 65618, // clPolygonView + vcData		viewFlags: vVisible + vCalculateBounds + vNoScripts,		viewFormat: vfPen(2),		points: MakeBinaryFromHex("000E0000", 'polygonShape),		debug: 5572	}];